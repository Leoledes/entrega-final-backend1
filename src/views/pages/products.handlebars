<h1>Cat√°logo de Productos</h1>

{{#if products.length}}
  <div class="products-container">
    {{#each products}}
      <div class="product-card" data-id="{{this.id}}">
        {{#if this.thumbnails.[0]}}
          <img src="{{this.thumbnails.[0]}}" alt="{{this.name}}" class="product-img">
        {{else}}
          <img src="https://via.placeholder.com/200x200?text=Sin+Imagen" alt="Sin imagen" class="product-img">
        {{/if}}

        <div class="product-info">
          <h3>{{this.name}}</h3>
          <p>ID: {{this.id}}</p>
          <p>{{this.description}}</p>
          <span class="price-tag">
            $ {{this.price}} <span>(Stock: {{this.stock}})</span>
          </span>
          <p>Categor√≠a: {{this.category}}</p>
        </div>

        <div class="actions-container">
          <a href="/products/{{this.id}}" class="btn-detail">Ver Detalle</a>
          <button onclick="addToCart('{{this.id}}')">üõí Agregar</button>
        </div>
      </div>
    {{/each}}
  </div>
  {{#if pagination}}
    <div class="pagination-container" style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 30px 0; padding: 20px;">
      
      {{!-- Bot√≥n Anterior --}}
      {{#if pagination.hasPrevPage}}
        <a href="/products?page={{pagination.prevPage}}{{#if pagination.limit}}&limit={{pagination.limit}}{{/if}}{{#if pagination.query}}&query={{pagination.query}}{{/if}}{{#if pagination.sort}}&sort={{pagination.sort}}{{/if}}" 
           style="padding: 10px 20px; background: #4CAF50; color: white; text-decoration: none; border-radius: 5px;">
          ‚Üê Anterior
        </a>
      {{else}}
        <span style="padding: 10px 20px; background: #ccc; color: #666; border-radius: 5px; cursor: not-allowed;">
          ‚Üê Anterior
        </span>
      {{/if}}

      {{!-- Indicador de p√°gina actual --}}
      <span style="font-weight: bold; font-size: 16px;">
        P√°gina {{pagination.currentPage}} de {{pagination.totalPages}}
      </span>

      {{!-- Bot√≥n Siguiente --}}
      {{#if pagination.hasNextPage}}
        <a href="/products?page={{pagination.nextPage}}{{#if pagination.limit}}&limit={{pagination.limit}}{{/if}}{{#if pagination.query}}&query={{pagination.query}}{{/if}}{{#if pagination.sort}}&sort={{pagination.sort}}{{/if}}" 
           style="padding: 10px 20px; background: #4CAF50; color: white; text-decoration: none; border-radius: 5px;">
          Siguiente ‚Üí
        </a>
      {{else}}
        <span style="padding: 10px 20px; background: #ccc; color: #666; border-radius: 5px; cursor: not-allowed;">
          Siguiente ‚Üí
        </span>
      {{/if}}
      
    </div>
  {{/if}} 
{{else}}
  <p class="no-products">No hay productos cargados.</p>
{{/if}}

<script>
  window.cartId = "{{cartId}}";
</script>

<script src="/socket.io/socket.io.js"></script>
<script src="/js/cart.js"></script>
